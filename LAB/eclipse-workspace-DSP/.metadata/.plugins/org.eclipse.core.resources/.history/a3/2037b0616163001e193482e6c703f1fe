package ciociaria.annunci.it.model.repository.converter;

import org.bson.types.ObjectId;
import org.springframework.core.convert.converter.Converter;
import org.springframework.data.convert.WritingConverter;
import org.springframework.stereotype.Component;

import ciociaria.annunci.it.model.bean.Comune;
import ciociaria.annunci.it.model.bean.Utente;
import lombok.AllArgsConstructor;

@AllArgsConstructor
@WritingConverter
@Component
public class ComuneToObjectIDConverter implements Converter<Comune, Object> {

	@Override
	public Object convert(Comune comune) {
		
		System.out.println("Chiamata converter: " + comune.toString());
		
		StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace();
        for (StackTraceElement element : stackTraceElements) {
            if (element.getClassName().equals(Utente.class)) {
                // Se la classe Ã¨ Utente, esegui la conversione in ObjectID
                return new ObjectId(comune.getId());
            }
        }
        
        System.out.println("Annunci");
        
		return comune;
	}

}

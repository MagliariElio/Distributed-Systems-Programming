package logic;

import org.bson.Document;

import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import com.mongodb.client.model.CreateCollectionOptions;
import com.mongodb.client.model.Filters;
import com.mongodb.client.model.ValidationOptions;

import logic.dao.Database;
import logic.exception.DatabaseException;

public class Starter {

	public static void main(String[] args) throws DatabaseException {
		String user = args[1];
		String password = args[3];
				
		Database instance = Database.getInstance(user, password);
		
		MongoDatabase connection = instance.getConnection();
		
		MongoCollection<Document> utenteCollection = connection.getCollection("utente");
		utenteCollection.find();
		
		ValidationOptions collOptions = new ValidationOptions().validator(
			    Filters.or(Filters.exists("commander"), Filters.exists("first officer")));
			connection.createCollection("ships",
			    new CreateCollectionOptions().validationOptions(collOptions));
		
		for(String collection: connection.listCollectionNames()) {
			System.out.println(collection);
		}
	}

}
